{"version":3,"file":"s3.util.js","sourceRoot":"/","sources":["common/s3.util.ts"],"names":[],"mappings":";;;AACA,sCAAsC;AACtC,yCAAyC;AACzC,+BAA+B;AAE/B,MAAM,eAAe,GAAG,CAAC,OAAwB,EAAU,EAAE;IACzD,MAAM,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,WAAW,CAAC;IAC7C,OAAO,cAAc,MAAM,gBAAgB,CAAC;AAChD,CAAC,CAAC;AAEF,SAAgB,cAAc,CAAC,OAAwB;IACnD,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC;QACd,WAAW,EAAE,OAAO,CAAC,WAAW;QAChC,eAAe,EAAE,OAAO,CAAC,eAAe;QACxC,YAAY,EAAE,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,YAAY;QACnC,MAAM,EAAE,OAAO,CAAC,MAAM;KACzB,CAAC,CAAC;IACH,IAAI,OAAO,CAAC,UAAU,EAAE;QACpB,GAAG,CAAC,MAAM,CAAC,MAAM,CAAC;YACd,WAAW,EAAE;gBACT,KAAK,EAAE,IAAI,KAAK,CAAC,KAAK,CAAC;oBACnB,UAAU,EAAE,OAAO,CAAC,UAAU;iBACjC,CAAC;aACL;SACJ,CAAC,CAAC;KACN;IACD,IAAI,UAAU,GAAG,OAAO,CAAC,UAAU,KAAK,SAAS,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,OAAO,CAAC,UAAU,CAAC;IACtF,IAAI,QAAQ,GAAG,OAAO,CAAC,QAAQ,IAAI,eAAe,CAAC,OAAO,CAAC,CAAC;IAC5D,IAAI,MAAM,GAA2B;QACjC,UAAU;QACV,QAAQ;KACX,CAAC;IACF,MAAM,MAAM,GAAG,IAAI,EAAE,CAAC,MAAM,CAAC,CAAC;IAC9B,OAAO,MAAM,CAAC;AAClB,CAAC;AAxBD,wCAwBC","sourcesContent":["import { S3ConfigOptions } from \"../interfaces/s3-options.interface\";\nimport * as AWS from 'aws-sdk/global';\nimport * as S3 from 'aws-sdk/clients/s3';\nimport * as https from 'https';\n\nconst defaultEndpoint = (options: S3ConfigOptions): string => {\n    const region = options.region || 'us-east-1';\n    return `https://s3.${region}.amazonaws.com`;\n};\n\nexport function createS3Client(options: S3ConfigOptions): S3 {\n    AWS.config.update({\n        accessKeyId: options.accessKeyId,\n        secretAccessKey: options.secretAccessKey,\n        sessionToken: options?.sessionToken,\n        region: options.region\n    });\n    if (options.maxSockets) {\n        AWS.config.update({\n            httpOptions: {\n                agent: new https.Agent({\n                    maxSockets: options.maxSockets\n                })\n            }\n        });\n    }\n    let apiVersion = options.apiVersion === undefined ? '2006-03-01' : options.apiVersion;\n    let endpoint = options.endpoint || defaultEndpoint(options);\n    let params: S3.ClientConfiguration = {\n        apiVersion,\n        endpoint\n    };\n    const client = new S3(params);\n    return client;\n}\n"]}